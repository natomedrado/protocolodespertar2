
<!-- Sticky Urgency Bar -->
<div class="fixed top-0 w-full bg-[#E50914] z-50 py-2 text-center text-white font-bold text-xs md:text-sm shadow-lg">
  <span class="animate-pulse">⚠️ ALERTA:</span> O acesso a este Protocolo fecha em <span class="font-mono">{{ timerDisplay() }}</span> minutos.
</div>

<div class="mt-10 md:mt-12 hero-gradient min-h-screen relative pb-20 overflow-hidden">
  
  <!-- Header -->
  <header class="container mx-auto px-4 pt-10 pb-6 text-center relative z-10">
    <div class="mb-4">
      <span class="text-[10px] md:text-xs tracking-[0.3em] text-gray-400 uppercase border border-gray-600 px-2 py-1 rounded">Dossiê Confidencial</span>
    </div>
    <h1 class="text-3xl md:text-5xl lg:text-6xl font-black tracking-tighter leading-tight mb-2 text-white drop-shadow-2xl">
      "SE ELE(A) MENTE PARA VOCÊ,<br><span class="text-[#E50914]">VAMOS DESCOBRIR AGORA</span>"
    </h1>
    <p class="text-gray-400 text-xs md:text-base max-w-2xl mx-auto mt-4">
      Baseado em neurociência comportamental. Assista ao vídeo antes que ele seja retirado do ar.
    </p>
  </header>

  <!-- VSL Section -->
  <section class="container mx-auto px-4 relative z-10 max-w-4xl">
    <div class="relative w-full aspect-video bg-black rounded-lg shadow-2xl overflow-hidden border border-gray-800 group">
      <div class="vignette absolute top-0 left-0 w-full h-full pointer-events-none z-10"></div>
      
      <video 
        #videoPlayer
        (timeupdate)="onVideoTimeUpdate()"
        class="w-full h-full object-cover" 
        controls autoplay muted playsinline 
        poster="https://placehold.co/1920x1080/000000/FFF?text=Carregando+Dossiê...">
        <source src="https://codigosocul-gbv8rqvf.manus.space/videos/vsl_final_v2_optimized.mp4" type="video/mp4">
        Seu navegador não suporta a tag de vídeo.
      </video>
    </div>

    <!-- Loading Bar -->
    @if (!contentUnlocked()) {
      <div class="mt-6 max-w-lg mx-auto transition-opacity duration-500">
        <p class="text-center text-gray-400 text-xs mb-2 font-semibold">
          <span class="text-[#E50914] animate-pulse">⚠️ Sincronizando banco de dados neural...</span> <br>
          O acesso ao Dossiê será liberado automaticamente.
        </p>
        <div class="w-full bg-zinc-900 rounded-full h-2 overflow-hidden border border-zinc-800 shadow-inner relative">
          <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-transparent via-white/5 to-transparent animate-pulse z-10"></div>
          <div class="bg-gradient-to-r from-red-800 to-[#E50914] h-full rounded-full transition-all duration-300 ease-linear shadow-[0_0_10px_rgba(229,9,20,0.5)]" 
               [style.width.%]="progressWidth()"></div>
        </div>
        <div class="flex justify-between text-[10px] text-gray-600 mt-1 px-1">
          <span>Analisando...</span>
          <span>{{ Math.floor(progressWidth()) }}%</span>
        </div>
      </div>
    }

    <div class="text-center mt-4 text-gray-600 text-[10px] flex justify-center items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
      Conexão Segura e Criptografada
    </div>
  </section>

  <!-- LOCKED CONTENT -->
  @if (contentUnlocked()) {
    <div class="animate-[fadeIn_1s_ease-out_forwards]">
      
      <!-- Scarcity Widget -->
      <div class="container mx-auto px-4 mt-8 max-w-2xl">
        <div class="bg-zinc-900 border border-red-900/30 rounded-lg p-4 flex items-center justify-between shadow-lg animate-pulse">
          <div class="flex items-center gap-3">
            <div class="w-2 h-2 rounded-full bg-red-500"></div>
            <span class="text-gray-300 text-sm font-semibold">Vagas restantes para o protocolo:</span>
          </div>
          <span class="text-[#E50914] font-black text-xl">{{ spotsLeft() }}</span>
        </div>
      </div>

      <!-- CTA 1 -->
      <section class="container mx-auto px-4 mt-10 text-center">
        <button (click)="scrollToCheckout()" class="bg-[#E50914] text-white text-xl md:text-2xl font-bold py-4 px-8 md:px-16 rounded shadow-[0_0_0_0_rgba(229,9,20,0.7)] hover:bg-[#b20710] animate-[pulse-red_2s_infinite] transform hover:scale-105 transition-all duration-300 w-full md:w-auto">
          QUERO DESCOBRIR A VERDADE
        </button>
        <p class="mt-3 text-gray-500 text-xs">Acesso imediato • Compra 100% Segura</p>
      </section>

      <!-- AI TOOLS SECTION -->
      <section class="container mx-auto px-4 mt-16 max-w-4xl">
        <div class="border border-zinc-700 bg-black/50 rounded-xl p-1 shadow-2xl overflow-hidden relative">
          <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-red-600 to-transparent opacity-50"></div>
          
          <div class="p-6 md:p-8">
            <div class="flex items-center gap-2 mb-6">
              <span class="animate-pulse text-red-500 text-xl">✨</span>
              <h2 class="text-2xl font-bold text-white tracking-wide">LABORATÓRIO DE DEFESA NEURAL</h2>
            </div>
            <p class="text-gray-400 text-sm mb-8">Utilize nossa IA treinada em psicologia comportamental para analisar mensagens ou gerar defesas em tempo real.</p>

            <div class="grid md:grid-cols-2 gap-8">
              
              <!-- Tool 1: Analyzer -->
              <div class="bg-zinc-900/80 p-6 rounded-lg border border-zinc-800 hover:border-zinc-600 transition-colors">
                <h3 class="font-bold text-lg text-white mb-3 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                  Decodificador de Manipulação
                </h3>
                <p class="text-xs text-gray-500 mb-4">Cole uma mensagem suspeita para detectar Gaslighting.</p>
                <textarea [formControl]="analyzerControl" class="w-full h-32 bg-[#1a1a1a] border border-[#333] focus:border-[#E50914] outline-none text-white rounded p-3 text-sm resize-none mb-4 transition-colors" placeholder="Ex: 'Você é louca, eu nunca disse isso...'"></textarea>
                <button (click)="analyzeMessage()" [disabled]="isAnalyzing()" class="w-full bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 text-white font-semibold py-2 rounded flex justify-center items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                  @if (isAnalyzing()) {
                    <span class="animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"></span>
                    Analisando...
                  } @else {
                    ✨ Analisar Toxicidade
                  }
                </button>
                @if (analyzerResult()) {
                  <div class="mt-4 text-sm text-gray-300 border-l-4 border-[#E50914] pl-3 py-1 bg-gradient-to-r from-[rgba(229,9,20,0.1)] to-transparent whitespace-pre-wrap animate-[fadeIn_0.5s_ease-out]">
                    {{ analyzerResult() }}
                  </div>
                }
              </div>

              <!-- Tool 2: Generator -->
              <div class="bg-zinc-900/80 p-6 rounded-lg border border-zinc-800 hover:border-zinc-600 transition-colors">
                <h3 class="font-bold text-lg text-white mb-3 flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  Gerador de Escudo
                </h3>
                <p class="text-xs text-gray-500 mb-4">Insira a provocação e receba respostas frias.</p>
                <textarea [formControl]="generatorControl" class="w-full h-32 bg-[#1a1a1a] border border-[#333] focus:border-[#E50914] outline-none text-white rounded p-3 text-sm resize-none mb-4 transition-colors" placeholder="Ex: 'Por que você não me responde mais?'"></textarea>
                <button (click)="generateGreyRock()" [disabled]="isGenerating()" class="w-full bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 text-white font-semibold py-2 rounded flex justify-center items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                  @if (isGenerating()) {
                     <span class="animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"></span>
                     Gerando...
                  } @else {
                    ✨ Gerar Defesa
                  }
                </button>
                @if (generatorResult()) {
                  <div class="mt-4 text-sm text-gray-300 border-l-4 border-[#E50914] pl-3 py-1 bg-gradient-to-r from-[rgba(229,9,20,0.1)] to-transparent whitespace-pre-wrap animate-[fadeIn_0.5s_ease-out]">
                    {{ generatorResult() }}
                  </div>
                }
              </div>

            </div>
          </div>
        </div>
      </section>

      <!-- Benefits & Social Proof -->
      <section class="bg-zinc-900 mt-20 py-16">
        <div class="container mx-auto px-4 max-w-4xl">
          <h2 class="text-2xl font-bold text-center mb-10 text-white">QUEM DESCOBRIU A VERDADE</h2>
          <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-black p-6 rounded-lg border border-zinc-800">
              <div class="flex gap-1 text-[#E50914] mb-3">★★★★★</div>
              <p class="text-gray-300 italic mb-4">"Eu achava que estava ficando louca. Ele me fazia pedir desculpas pelos erros dele. O 'Guia Clínico' foi como acender a luz."</p>
              <p class="text-white font-bold text-sm">- Mariana S., 29 anos</p>
            </div>
            <div class="bg-black p-6 rounded-lg border border-zinc-800">
              <div class="flex gap-1 text-[#E50914] mb-3">★★★★★</div>
              <p class="text-gray-300 italic mb-4">"Apliquei a técnica da Pedra Cinza ensinada no material e a reação dele foi imediata. Retomei o controle."</p>
              <p class="text-white font-bold text-sm">- Carla M., 34 anos</p>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQ Section -->
      <section class="container mx-auto px-4 mt-20 max-w-3xl">
        <h2 class="text-2xl font-bold text-center mb-8 text-white">PERGUNTAS FREQUENTES</h2>
        <div class="space-y-4">
          @for (faq of faqs; track $index) {
            <div class="border border-zinc-800 rounded-lg bg-zinc-900 overflow-hidden">
              <button class="w-full p-4 text-left font-semibold flex justify-between items-center text-white hover:bg-zinc-800 transition-colors" (click)="toggleFaq($index)">
                {{ faq.q }}
                <svg [class.rotate-180]="faqOpen() === $index" class="w-5 h-5 text-gray-400 transform transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
              </button>
              @if (faqOpen() === $index) {
                <div class="px-4 pb-4 text-gray-400 text-sm animate-[fadeIn_0.3s_ease-out]">
                  {{ faq.a }}
                </div>
              }
            </div>
          }
        </div>
      </section>

      <!-- Offer Section -->
      <section class="container mx-auto px-4 mt-20 mb-20 max-w-4xl text-center">
        <div class="bg-gradient-to-b from-zinc-900 to-black border border-zinc-800 rounded-2xl p-8 md:p-12 relative overflow-hidden">
          <div class="absolute top-0 right-0 bg-[#E50914] text-white text-xs font-bold px-3 py-1 rounded-bl-lg">OFERTA ÚNICA</div>
          
          <h3 class="text-3xl font-black text-white mb-2">ANATOMIA DO PREDADOR</h3>
          <p class="text-gray-400 mb-6">O Guia Definitivo + Bônus Exclusivos</p>
          
          <div class="flex justify-center items-end gap-2 mb-8">
            <span class="text-gray-500 line-through text-lg">R$ 197,00</span>
            <span class="text-5xl font-black text-white">R$ 47,00</span>
          </div>

          <button (click)="scrollToCheckout()" class="w-full md:w-2/3 bg-[#E50914] text-white text-xl font-bold py-5 px-8 rounded hover:bg-[#b20710] transition-all mb-6 shadow-[0_0_0_0_rgba(229,9,20,0.7)] animate-[pulse-red_2s_infinite]">
            QUERO ACESSO IMEDIATO
          </button>

          <div class="flex flex-col items-center justify-center gap-2 mt-8 opacity-80">
            <div class="w-16 h-16 rounded-full border-2 border-white flex items-center justify-center mb-2">
              <span class="font-black text-xl text-white">7</span>
            </div>
            <h4 class="font-bold text-white">GARANTIA BLINDADA</h4>
            <p class="text-xs text-gray-400 max-w-xs">Se você não sentir que este material abriu seus olhos em 7 dias, devolvemos 100% do seu dinheiro.</p>
          </div>
        </div>
      </section>

      <footer class="text-center text-gray-600 text-xs py-8 border-t border-zinc-900">
        <p>&copy; 2024 Anatomia do Predador. Todos os direitos reservados.</p>
        <p class="mt-2">Este site não faz parte do Facebook ou Facebook Inc.</p>
      </footer>
    </div>
  }

</div>

<!-- FOMO Toast -->
<div class="fixed bottom-4 left-4 bg-white text-black p-3 rounded-lg shadow-2xl flex items-center gap-3 transform transition-transform duration-500 z-50 border-l-4 border-[#E50914] max-w-xs"
     [class.translate-y-full]="!showFomo()"
     [class.translate-y-0]="showFomo()">
    <div class="w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center flex-shrink-0">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
    </div>
    <div>
        <p class="text-xs font-bold">{{ fomoUser().name }}</p>
        <p class="text-xs text-gray-600">{{ fomoUser().action }}</p>
        <p class="text-[10px] text-green-600 font-semibold">Há 2 minutos</p>
    </div>
</div>

<!-- Exit Modal -->
@if (showExitModal()) {
  <div class="fixed inset-0 bg-black/90 z-[60] flex items-center justify-center backdrop-blur-sm p-4 animate-[fadeIn_0.3s_ease-out]">
    <div class="bg-zinc-900 border border-red-600 rounded-xl p-6 max-w-md w-full text-center relative shadow-2xl">
      <button (click)="closeExitModal()" class="absolute top-2 right-2 text-gray-400 hover:text-white">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
      </button>
      <h3 class="text-2xl font-black text-white mb-2">ESPERE! NÃO VÁ AINDA...</h3>
      <p class="text-gray-300 mb-4 text-sm">Você está prestes a perder a chance de descobrir a verdade.</p>
      <div class="bg-black/50 p-4 rounded mb-4">
        <p class="text-red-500 font-bold uppercase text-xs">Última chance</p>
        <p class="text-white font-bold text-lg">Leve por apenas R$ 37,00</p>
      </div>
      <button (click)="scrollToCheckout()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded transition-colors">
        RESGATAR DESCONTO AGORA
      </button>
      <button (click)="closeExitModal()" class="block w-full mt-3 text-xs text-gray-500 underline hover:text-gray-300">
        Não, prefiro continuar na dúvida.
      </button>
    </div>
  </div>
}
